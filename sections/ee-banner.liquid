{% comment %}
  EcomExperts Test – Custom Banner Section (no jQuery)
  - Mobile: hamburger at left that morphs to X when toggled and reveals a dropdown with tagline + CTA
  - Editable fields: brand, tagline, top CTA, title, subtitle, main CTA, strip, background.
{% endcomment %}

<section id="ee-banner-{{ section.id }}" class="ee-banner">
  <div class="ee-banner__topbar">
    <!-- Mobile hamburger (hidden on desktop) -->
    <button class="ee-hamburger" aria-expanded="false" aria-controls="ee-mobile-drawer-{{ section.id }}" aria-label="Open menu">
      <span class="ee-hamburger__bar"></span>
    </button>

    <div class="ee-banner__brand">{{ section.settings.brand_text }}</div>
    <div class="ee-banner__tagline">{{ section.settings.tagline }}</div>

    {% if section.settings.top_cta_text != blank %}
      <a class="ee-btn ee-btn--top" href="{{ section.settings.top_cta_link | default: '#' }}">
        <span>{{ section.settings.top_cta_text }}</span>
        <span class="ee-arrow" aria-hidden="true">→</span>
      </a>
    {% endif %}
  </div>

  {%- comment -%} Mobile dropdown panel (shown when hamburger open) {%- endcomment -%}
  <div id="ee-mobile-drawer-{{ section.id }}" class="ee-mobile-drawer" aria-hidden="true">
    <p class="ee-mobile-tagline">{{ section.settings.tagline }}</p>
    {% if section.settings.top_cta_text != blank %}
      <a class="ee-btn ee-btn--top" href="{{ section.settings.top_cta_link | default: '#' }}">
        <span>{{ section.settings.top_cta_text }}</span>
        <span class="ee-arrow" aria-hidden="true">→</span>
      </a>
    {% endif %}
  </div>

  <div
    class="ee-banner__hero"
    role="img"
    aria-label="{{ section.settings.bg_alt | escape }}"
    {% if section.settings.bg_image %}
      style="--bg:url({{ section.settings.bg_image | image_url }})"
    {% endif %}
  >
    <!-- Text block -->
    <div class="ee-banner__inner">
      <h1 class="ee-banner__title">{{ section.settings.title }}</h1>
      {% if section.settings.subtitle != blank %}
        <p class="ee-banner__subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}

      {% if section.settings.main_cta_text != blank %}
        <a class="ee-btn ee-btn--primary" href="{{ section.settings.main_cta_link | default: '#' }}">
          <span>{{ section.settings.main_cta_text }}</span>
          <span class="ee-arrow" aria-hidden="true">→</span>
        </a>
      {% endif %}
    </div>

    <!-- Mobile-only image block (keeps text on white, image below) -->
    <div class="ee-hero-img" aria-hidden="true"></div>
  </div>

  {% if section.settings.bottom_strip != blank %}
    <div class="ee-banner__strip">
      <span>{{ section.settings.bottom_strip }}</span>
    </div>
  {% endif %}
</section>

<style>
  /* ---- Scoped styles ---- */
  #ee-banner-{{ section.id }} {
    --max: 1200px;
    --pad: 20px;
    --black: #111;
    --white: #fff;
    --accent: #FCEB00; /* yellow */
    --gray: #efefef;
  }

  /* Top bar layout (desktop default) */
  #ee-banner-{{ section.id }} .ee-banner__topbar{
    display:grid; grid-template-columns:auto 1fr auto; align-items:center;
    gap:16px; background:#f3f3f3; padding:10px var(--pad); font-weight:600;
  }
  #ee-banner-{{ section.id }} .ee-banner__brand{ justify-self:start; }
  #ee-banner-{{ section.id }} .ee-banner__tagline{ justify-self:center; text-align:center; }
  #ee-banner-{{ section.id }} .ee-banner__topbar .ee-btn--top{
    justify-self:end; width:max-content; white-space:nowrap;
  }

  /* Hamburger (hidden on desktop) */
  #ee-banner-{{ section.id }} .ee-hamburger{
    display:none; position:relative; width:32px; height:28px;
    background:transparent; border:none; padding:0; cursor:pointer;
  }
  #ee-banner-{{ section.id }} .ee-hamburger__bar,
  #ee-banner-{{ section.id }} .ee-hamburger__bar::before,
  #ee-banner-{{ section.id }} .ee-hamburger__bar::after{
    content:""; position:absolute; left:0; right:0; height:2px; background:#000;
    transition: transform .25s ease, opacity .2s ease, top .25s ease, bottom .25s ease;
  }
  #ee-banner-{{ section.id }} .ee-hamburger__bar{ top:50%; transform:translateY(-50%); }
  #ee-banner-{{ section.id }} .ee-hamburger__bar::before{ top:-8px; }
  #ee-banner-{{ section.id }} .ee-hamburger__bar::after{ bottom:-8px; }
  /* Morph to X when open */
  #ee-banner-{{ section.id }} .ee-hamburger[aria-expanded="true"] .ee-hamburger__bar{ background:transparent; }
  #ee-banner-{{ section.id }} .ee-hamburger[aria-expanded="true"] .ee-hamburger__bar::before{ top:0; transform:rotate(45deg); }
  #ee-banner-{{ section.id }} .ee-hamburger[aria-expanded="true"] .ee-hamburger__bar::after{ bottom:0; transform:rotate(-45deg); }

  /* Buttons – base (no border, fit text) */
  #ee-banner-{{ section.id }} .ee-btn{
    position:relative; overflow:hidden; isolation:isolate;
    display:inline-flex; align-items:center; gap:.5rem;
    padding:.55rem 1.2rem;
    text-decoration:none; line-height:1; cursor:pointer;
    border:none; outline:none; width:max-content; white-space:nowrap;
  }
  /* Left→Right fill animation via ::before (slower) */
  #ee-banner-{{ section.id }} .ee-btn::before{
    content:""; position:absolute; inset:0; transform:scaleX(0);
    transform-origin:left; transition:transform .6s ease;
    z-index:-1;
  }
  #ee-banner-{{ section.id }} .ee-btn:hover::before{ transform:scaleX(1); }

  /* Top right button (CHOOSE GIFT): yellow base → black on hover */
  #ee-banner-{{ section.id }} .ee-btn--top{ background:var(--accent); color:#000; font-weight:600; }
  #ee-banner-{{ section.id }} .ee-btn--top::before{ background:#000; }
  #ee-banner-{{ section.id }} .ee-btn--top:hover{ color:#fff; }

  /* Main CTA (SHOP NOW): black → yellow on hover */
  #ee-banner-{{ section.id }} .ee-btn--primary{ background:#000; color:#fff; padding:.65rem 1.3rem; }
  #ee-banner-{{ section.id }} .ee-btn--primary::before{ background:var(--accent); }
  #ee-banner-{{ section.id }} .ee-btn--primary:hover{ color:#000; }

  /* Arrow blink */
  @keyframes arrow-blink { 0%,100%{opacity:1;} 50%{opacity:0;} }
  #ee-banner-{{ section.id }} .ee-btn .ee-arrow{ margin-left:.4rem; display:inline-block; }
  #ee-banner-{{ section.id }} .ee-btn:hover .ee-arrow{ animation:arrow-blink .8s infinite; }

  /* Mobile dropdown panel (hidden on desktop; slide with max-height) */
  #ee-banner-{{ section.id }} .ee-mobile-drawer{
    display:none; overflow:hidden; max-height:0; transition:max-height .3s ease, padding .3s ease;
    background:#fff; padding:0 var(--pad); text-align:center; box-shadow:0 0 0 transparent;
  }
  #ee-banner-{{ section.id }}.menu-open .ee-mobile-drawer{
    max-height:220px; padding:14px var(--pad) 18px; box-shadow:0 2px 0 #e8e8e8;
  }
  #ee-banner-{{ section.id }} .ee-mobile-tagline{ margin:0 0 12px; font-weight:600; }

  /* Hero (desktop: text sits in white area above image) */
  #ee-banner-{{ section.id }} .ee-banner__hero{
    background: var(--white);
    background-image: var(--bg);
    background-size: cover; background-position: center 40%; /* push art slightly down */
    min-height: 520px;

    display:flex;
    align-items:flex-end;         /* push inner to bottom */
    justify-content:center;
    position:relative;
  }
  #ee-banner-{{ section.id }} .ee-banner__inner{
    width:100%; max-width:var(--max);
    padding: 36px var(--pad) 56px;  /* bottom padding like comp */
    text-align:left;
  }
  /* Slightly smaller text to fit in white band */
  #ee-banner-{{ section.id }} .ee-banner__title{
    font-size: clamp(36px, 5.2vw, 72px);
    line-height:1.05; margin:.2em 0 .1em;
  }
  #ee-banner-{{ section.id }} .ee-banner__subtitle{
    max-width: 680px; font-size: .98rem; line-height:1.55; color:#333;
  }

  /* Mobile image block: hidden on desktop */
  #ee-banner-{{ section.id }} .ee-hero-img{ display:none; }

  /* Bottom strip */
  #ee-banner-{{ section.id }} .ee-banner__strip{
    display:flex; justify-content:center; align-items:center;
    background:#eee; font-size:.78rem; padding:8px 12px; border-top:1px solid #ddd; letter-spacing:.06em;
  }

  /* Mobile */
  @media (max-width: 768px){
    /* show hamburger; center brand; hide tagline + top CTA in topbar */
    #ee-banner-{{ section.id }} .ee-hamburger{ display:block; }
    #ee-banner-{{ section.id }} .ee-banner__brand{ justify-self:center; }
    #ee-banner-{{ section.id }} .ee-banner__tagline,
    #ee-banner-{{ section.id }} .ee-banner__topbar .ee-btn--top{ display:none; }

    /* enable drawer on mobile */
    #ee-banner-{{ section.id }} .ee-mobile-drawer{ display:block; }

    #ee-banner-{{ section.id }} .ee-banner__topbar{
      grid-template-columns: auto 1fr auto;
      font-size:1rem; padding: 12px var(--pad);
    }

    /* MOBILE: text on white first, image below */
    #ee-banner-{{ section.id }} .ee-banner__hero{
      background:none;            /* remove background from container */
      min-height:auto;            /* let content define height */
      align-items:stretch;
    }
    #ee-banner-{{ section.id }} .ee-banner__inner{
      text-align:center;
      padding: 22px var(--pad) 16px;   /* compact and in white area */
      background:#fff;
    }
    #ee-banner-{{ section.id }} .ee-banner__title{
      font-size: 1.75rem;         /* ~28px */
      margin-bottom:.5rem;
    }
    #ee-banner-{{ section.id }} .ee-banner__subtitle{
      font-size:.95rem; max-width: 92%; margin:0 auto 1rem; line-height:1.5;
    }
    #ee-banner-{{ section.id }} .ee-btn--primary{
      margin: 0 auto; display:inline-flex;
    }

    /* The image portion appears below text */
    #ee-banner-{{ section.id }} .ee-hero-img{
      display:block; height: 230px;      /* adjust to match comp height */
      background-image: var(--bg);
      background-size: cover;
      background-position: center;
    }

    /* Bottom strip tighter */
    #ee-banner-{{ section.id }} .ee-banner__strip{ font-size:.7rem; padding:6px 8px; }
  }
</style>

<script>
  /* Toggle the inline mobile dropdown and morph hamburger */
  document.addEventListener('DOMContentLoaded', function () {
    var root = document.querySelector('#ee-banner-{{ section.id }}');
    if (!root) return;
    var hb = root.querySelector('.ee-hamburger');
    var drawer = root.querySelector('#ee-mobile-drawer-{{ section.id }}');
    if (!hb || !drawer) return;

    hb.addEventListener('click', function () {
      var expanded = hb.getAttribute('aria-expanded') === 'true';
      hb.setAttribute('aria-expanded', expanded ? 'false' : 'true');
      drawer.setAttribute('aria-hidden', expanded ? 'true' : 'false');
      root.classList.toggle('menu-open', !expanded);
    });
  });
</script>

{% schema %}
{
  "name": "EE • Banner",
  "tag": "section",
  "settings": [
    { "type": "text", "id": "brand_text", "label": "Brand (top-left)", "default": "TISSO VISION" },
    { "type": "text", "id": "tagline", "label": "Top center tagline", "default": "Find the ideal gift for your loved ones." },
    { "type": "text", "id": "top_cta_text", "label": "Top right button text", "default": "CHOOSE GIFT" },
    { "type": "url", "id": "top_cta_link", "label": "Top right button link" },

    { "type": "text", "id": "title", "label": "Main Title", "default": "The Gift Guide" },
    { "type": "textarea", "id": "subtitle", "label": "Subtitle paragraph", "default": "Discover Joy: Your Ultimate Holiday Gift Destination. Explore our curated selection and find the perfect gifts to delight your loved ones this holiday season." },
    { "type": "text", "id": "main_cta_text", "label": "Main CTA text", "default": "SHOP NOW" },
    { "type": "url", "id": "main_cta_link", "label": "Main CTA link" },

    { "type": "image_picker", "id": "bg_image", "label": "Background image (hero)" },
    { "type": "text", "id": "bg_alt", "label": "Background image alt", "default": "Gift guide background" },

    { "type": "text", "id": "bottom_strip", "label": "Bottom strip text", "default": "SUSTAINABLE, ETHICALLY MADE CLOTHES IN SIZES XXS TO 6XL" }
  ],
  "presets": [{ "name": "EE • Banner" }]
}
{% endschema %}
